import { initializeApp, cert, getApp} from 'firebase-admin/app';
import admin from 'firebase-admin'
import {Firestore, getFirestore, Timestamp, FieldValue } from 'firebase-admin/firestore';
import App from 'next/app';
import { Storage } from '@google-cloud/storage';
import { decrypt } from '../lib/crypto'
const encrypted = "fcdef80c16da16343764755bfe71e13d305acce3a64bf4e4e920091f0aa975b25f499a256eaba007f1d70c7d8ea145f4f550ca190e3b5f066ef9e1867b9eb09c5120c6825952414a697f896f8090366e899ee360e68c0d0fa453613425079968e3c6e1fc401b7eabfa9014aa537165ff81bd810a40e86019c0d0939f95ee6ceb1e1104ef3b46e408a80813e82db5344ea62e81d0ae636137761ebcfb33df9607e2fd4f7fce4273fefe85bd9e935704b473f60b765aec170538b7c328a0ade72a4f90114ccd1f4fbe9c885ba460cd764411353ac600420b9cc9f2402c52eabf7e943e19fc050d8407520cb6b428eb18948227d69ee4fadc122ef1d513ca3d761ab090adcc68ea89b43cca8cd78c4315c2e38bb005ac01e7782a3ef61de440b5961fe6b93014dd5a8508ce430889531c79aaaf1e51a62f8abc7d34db5779550b3c987bf15b8d73fed8f85a58f0cd0940f9311686f691097a7bb4c859e41b7655b22b5ce9281030571b14745e4cd85ca7fffbace0c61382d9f9b9a72bb102a025ce5edeefd020b53caddeb14a38bfcca52a56937058b3392a01cfaf5280266c5fb0a9bd5d77c9316eb0be3b43433809667caeb4c0d8673468f313081e2d623e70c78929ab9d67bee4cb2dfabb3ae76e2d6e00e97e048a0078c0d9794818d001273b3356a1dc142ca0275d6b70d3752ceeba60f1b53a7018f2fd048dbc90377b6ca8e55ebf4bd0b1e2be042b88b9d0935cdd90de842cc2a8d067b28f57cd646a838dbbdee2ca2141e07423a8c51d24c065bc20fabee1a2911b42dfa3fa2d7a0360c95bf8ec5bd1ded3a58651d7aa6084399f779eed84e795f91231d0be501f63a7e22af6ac484c96579328bb2c130e19d001cf2482990846daf211fe45ea007d7865bca09ba886e9c41f288ac4ca3995444e85464d561bec91ca56a38b1d0ad901462e56e80438641a7246a1fc9ff9f0183431fa0a47e0147c71c30461e4fe532f8d7488a7500c49cdcb1d59e17cb55b3a1d4fd5666bcc2c9921d94314def55dcb3c5efe6f6d8681712f86cb4eb619f5c6bc6e1c4c697520fe1b56f524f30fac548faae11b0614b204f0b0d6f2983ff085947b5bd9e9704526041e77b1cca548dd40a888907cd018a72c056994404bdef79d853e54df11baa6de076117c0f1b15d329255caca573b13f3471205ce280e7206f641e4485631b2a3e47f7c8ba22b8ccf5625840edca577aaeaae7b214dca101aad13a920ea58d569f789952ab3ae06f6d8c1583bb03d9304c034846e6bc77c6b02567ddecd32e96ccf8e6adbbc5dc8a51eb4db2ed29e98a415222850f1de840c15b7dfe6be16e24f4567f8d0bbcb0be367eca1d05df10071a3c69f3dbbee4a2995e5d50c2fae70264c188ed985638c0d3f88794cebf7441a314f0a84b4a09eb153f46a757eecc4cdc30db239180d5c0c2599e064515f646f718a6246cf5849589eb0fe376b103dbaceb2bd0c4eca9faca5b0a2675327b5c661f2d6ed8f3e8711f342a97390099dbe2a577921b6ff680bdc036cbf891c1eacf6b8a42cc353f709357461d7869cd3f248763f1946e9bba2067d3cfd84aaf9c6e047085328580b75874e0d1614ee4cc894fb618023e22456df0b6078adc516dca48b0f80e45fe5ab855df7b6f758d19f45da07daeb1c736dc2825d100f1abb3e0e4d558e882604255c30236946d1d9ba5cbef876f7084340b157d4062c3af360ccc2674770738293f0fac8b810db5e29820df3af76bd64837099e33f7493d7682ce364a7f5effc8fd2d2d247a8b951506e7faad82059c265ec58b202e351e90860251053eab9a766adcaf833d4c23cf25a7e78d51f199962333818c7826d559ac189f2b74472942fa3cdde602d47776d48dce9af06ddd5920f6e583e1be44f4331b48559d0c280e7c3b053a098ba99c1e330b97ea843f90ee4f50d232f53825b120e7bda9dc39bb777dcf4fcc10bf13bba5d546cb7657b7f2d97b8b5375c6ca6ed3a3267d9d569d3437a804d0cf9369683c5859f5abb620f188b8cfaa654b6b404f4714d06b25e50201d068f490901a51e7e7714674330f2333bbda3c3253a78678fb95b1c027c926a1cbb61b9636d4ec6dbc7e2a7c651172a0e1a28ca859c1d76cb10527a2f4cd8659ad3eca2a997f8f95791418a0dd37236ebf6648185f58ee3d708c7456b943d15e519b61a0abb00ff3cc63bac372bcd031a5029973d6242f4b281759015717a11a94f474de24782ea3093d6abc05692c9be3c784e9f173ef569fe904628fa1f9dd6f3c275d9c4fb70cc98eb3484cc08f42cbc87d82789ce3d3120b1fccb25dce78f17c6fbe6c094008a8ecfc59669dfe7df8cc443d6ca79ed9c02ee89cccd77c4154b0fd134f95ea5ed2f2e8db4eb5f5cb0417a427aa77916e90ed3e397a9a0dccaea2760611f4f4fc5d97e3396f942062880d0c17ac52635ce5bf5f5c4157c8f3553b3ec597202a5b769e73e5ff79a819e7972f4b11a192712034b1a02ddb4d8a3fc2849fe4ca36d84313760345023f93bd5761266b5b042f79e7a13aaf458c7326ea6a1517e2799169a9970339447e1f4721528aea023e002bf52339efe2dfa164c10a37569b6584dd074cc5ee05b7384489c05e992c52e4ea33128cf5286e74ecb4fff409f88e1184ac3cb76ff7398ab74e3503c6371aecff94d86d6f2c648cb565d70c9a867ba1c514f9c4c152875c083594c1c053545c8cc1dc0c1737949ebbc2547ea57b835a168735c07a12d691f1c64efd2ccfe43ed08286ddc7e4f9ab67e817dca9872cc5461fcba9b65931597b5dff6575b4009dc1e501ce847442c575ecf3b03fa1e80a4c8815be15e89b504a6c1d6d779bed95e218255cec9eb9f9f01ce19418b1b6da8f68dfbc0c00fe46e90d31523c00dfe03e13adae84f51b05c3c49c54dccd24fb7166d6eec56994cd0d1977a430629f9897afc0ad7ed039169256a4a30332a0e72d960bc44172c727a516412a2ce8f5aff0c1854aa85b65fdf001741f9a6d9f1162985180e0091f14447b24a04107ac08e9365e350498f9c126168e5e97ccf582e367c2896dd731c5682efe621fcdab17f0f48aab58a91093605e6888e0a435c5dd792e7d43a9f868ef0a3ac4b52598edd47de0e351d22263c61305fd524ce777eefb78ceef201ddacd9e48da416ff74850f1d4a45c6b4c4c165c0e645d4992f012a7401e161d2ed98185c29eca6c51bb377028fa9caadb8b6db308e1ad24621be2330946c7bb82b8f26e311fc455efaf1765e04d79fde6e79c67c0ab311056cc2ae391c7d0431906153f62bc2f5674016ba01a651faeddee32b23a8ff4bfadd07b69ca1c91583994a8cca623e92513569382197bb913cd77a65124eecff5e6adf7b7b7b13d8c1e5dc867f8919ad69d1483948b7799a80b6bfdf495418565555e94ffc4df2392f2ddb705c8208d92ae3e79754375e008b719b4b84370f72e2c985d64e3f7d052002ac5c85fa282076c67d8d916bd42ecf5eba65fab04b0a4f09829bc1d9a6940898d62f6f6ef2bd5273dc88d7ceb11373083ceb91c06769678a93440fea12d246ad9dd76f4aa6c65f4a42b9fe86ff17a93371a7f577813543641477de536c4ec3d369e9b32b7249e58305b4a2c4d93e408ca77ed6af0e56cc9a3fb01a8e14d9a0c6b1b2ef3c4868d4e8cf4d6a82364509f4312af390fe668c751956876072729cfd47b88bf165cdd5d24f82a08b114ea7c8eda65064c7c63708bb5811101170b5a2cf2acbaea91c966c2f513fab73727e7c544857aba2018d21bc801361c956d1997ee313a405a5d089ddba3e9c8800ce688a965d7d081a5f089c60ce661932a5772297fb4a2602c2b7e7eb035dcba9ef0cd6286a21e6b9ac67ae668b05023bd8d149eb872b80e14d3863cdddd29edce6a460d0ff5c11fb05251e4051c3fc3a98d97a08b437c12d322d51986cc521568bda91aa71331e6154cdb404ca6388b3eba328f2cb228f9833a39952cf9b5f1bf644043d271d0e359efa0b8a1bc56a4ba20448d896e78254ad45957fccf46d96391286fc6352bd5cd6acc70f4ac6364c8c199e1d431b155d86b8fa577892a8237044674c1150742717384aaa4fda34c82c7a322a88a73ce3714ba97b47466e13d1f1c489fc0cce62b956a1361aacd4091d16fbedf55c24370039366c4cb217ca69fd7d8a7d278fa495cf77ddc01a1fcbe5cdfbdec57f318860045eb392abc97802f8e80f0095d0f578ffe1099201f66c76fc16bb9326fed68ccfa3a2027d4f6e201293f1befda3f70bade069a00f6f0b66e68bcd1a592bf002db1dcdaa7e1c1575d9efbe1aea05ec50555f6aa217e4583371c3d0218b6109d3a484fb4cab9f6f05"
const credential = JSON.parse(
  Buffer.from(decrypt(encrypted), 'base64').toString()
);
console.log(credential)

try {
  getApp();
} catch (e) {
  initializeApp({credential: cert(credential)});
}

const db = new Firestore({
  projectId: "ln-jukebox",
  credentials: credential 
});

const storage = new Storage({
  projectId: "ln-jukebox",
  credentials: credential 
})


export {
  db,
  storage
};